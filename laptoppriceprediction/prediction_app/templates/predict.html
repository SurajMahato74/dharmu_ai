{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 py-12 px-4">
  <div class="max-w-7xl mx-auto">

    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
        üíª Laptop Price Prediction System
      </h1>
      <p class="text-xl text-gray-600">Get accurate price predictions for your dream laptop configuration!</p>
    </div>

    <!-- Main Layout -->
    <div class="grid lg:grid-cols-3 gap-8">
      
      <!-- Configuration Panel -->
      <div class="lg:col-span-1">
        <div class="bg-white rounded-3xl shadow-2xl p-6 md:p-8">
          <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
            üéØ Configuration
          </h2>
          
          <form method="POST" class="space-y-6" id="laptopForm">
            {% csrf_token %}

            <!-- Brand -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Brand</label>
              <select name="brand" required class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                <option value="" disabled selected>Choose brand</option>
                <option value="HP">HP</option>
                <option value="Dell">Dell</option>
                <option value="Lenovo">Lenovo</option>
                <option value="Asus">Asus</option>
                <option value="Acer">Acer</option>
                <option value="Apple">Apple</option>
                <option value="MSI">MSI</option>
                <option value="Samsung">Samsung</option>
                <option value="Infinix">Infinix</option>
                <option value="Xiaomi">Xiaomi</option>
              </select>
            </div>

            <!-- Processor -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Processor</label>
              <select name="processor" required class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                <option value="" disabled selected>Select processor</option>
                <option value="12th Gen Intel Core i5">12th Gen Intel Core i5</option>
                <option value="13th Gen Intel Core i7">13th Gen Intel Core i7</option>
                <option value="11th Gen Intel Core i5">11th Gen Intel Core i5</option>
                <option value="5th Gen AMD Ryzen 5">5th Gen AMD Ryzen 5</option>
                <option value="7th Gen AMD Ryzen 7">7th Gen AMD Ryzen 7</option>
                <option value="12th Gen Intel Core i7">12th Gen Intel Core i7</option>
                <option value="13th Gen Intel Core i5">13th Gen Intel Core i5</option>
                <option value="11th Gen Intel Core i7">11th Gen Intel Core i7</option>
                <option value="5th Gen AMD Ryzen 7">5th Gen AMD Ryzen 7</option>
              </select>
            </div>

            <!-- RAM -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">RAM (GB)</label>
              <select name="ram" required class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                <option value="" disabled selected>Select RAM</option>
                <option value="4">4 GB</option>
                <option value="8">8 GB</option>
                <option value="16">16 GB</option>
                <option value="32">32 GB</option>
                <option value="64">64 GB</option>
              </select>
            </div>

            <!-- Storage -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Storage (GB)</label>
              <select name="storage" required class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                <option value="" disabled selected>Select storage</option>
                <option value="128">128 GB</option>
                <option value="256">256 GB</option>
                <option value="512">512 GB</option>
                <option value="1024">1024 GB (1TB)</option>
                <option value="2048">2048 GB (2TB)</option>
              </select>
            </div>

            <!-- Storage Type -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Storage Type</label>
              <select name="storage_type" required class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                <option value="" disabled selected>Select storage type</option>
                <option value="SSD">SSD</option>
                <option value="Hard-Disk">Hard Disk</option>
              </select>
            </div>

            <!-- Display Size -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Display Size (inches)</label>
              <input type="number" step="0.1" name="display_size" placeholder="e.g. 15.6" min="11" max="18" value="15.6" required 
                     class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
            </div>

            <!-- Resolution -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Screen Resolution</label>
              <select name="resolution" required class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                <option value="" disabled selected>Select resolution</option>
                <option value="1366x768">1366x768 (HD)</option>
                <option value="1920x1080">1920x1080 (Full HD)</option>
                <option value="2560x1440">2560x1440 (QHD)</option>
                <option value="3840x2160">3840x2160 (4K UHD)</option>
              </select>
            </div>

            <!-- GPU -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Graphics Card</label>
              <select name="gpu" required class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                <option value="" disabled selected>Select graphics card</option>
                <option value="Intel Integrated">Intel Integrated</option>
                <option value="Intel Iris Xe">Intel Iris Xe</option>
                <option value="NVIDIA GeForce RTX 3050">NVIDIA GeForce RTX 3050</option>
                <option value="NVIDIA GeForce RTX 4060">NVIDIA GeForce RTX 4060</option>
                <option value="AMD Radeon">AMD Radeon</option>
                <option value="NVIDIA GeForce GTX 1650">NVIDIA GeForce GTX 1650</option>
              </select>
            </div>

            <!-- Operating System -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Operating System</label>
              <select name="os" required class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                <option value="" disabled selected>Select OS</option>
                <option value="Windows 11 OS">Windows 11</option>
                <option value="Windows 10 OS">Windows 10</option>
                <option value="Mac OS">macOS</option>
                <option value="DOS OS">DOS</option>
                <option value="Chrome OS">Chrome OS</option>
              </select>
            </div>

            <!-- Additional Features -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="text-lg font-semibold text-gray-700 mb-4">üìä Additional Features</h3>
              
              <!-- Specification Rating -->
              <div class="mb-4">
                <label class="block text-sm font-semibold text-gray-700 mb-2">Specification Rating</label>
                <input type="range" name="spec_rating" min="50" max="90" value="70" step="0.1" 
                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" 
                       oninput="document.getElementById('spec_rating_value').textContent = this.value">
                <div class="flex justify-between text-xs text-gray-500 mt-1">
                  <span>50</span>
                  <span id="spec_rating_value">70</span>
                  <span>90</span>
                </div>
              </div>
              
              <!-- Warranty -->
              <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">Warranty (Years)</label>
                <select name="warranty" required class="w-full px-4 py-3 text-sm bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                  <option value="0">No Warranty</option>
                  <option value="1" selected>1 Year</option>
                  <option value="2">2 Years</option>
                  <option value="3">3 Years</option>
                </select>
              </div>
            </div>

            <!-- Budget -->
            <div class="bg-green-50 p-4 rounded-lg">
              <h3 class="text-lg font-semibold text-gray-700 mb-4">üí∞ Budget</h3>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Enter your budget (‚Çπ)</label>
              <input type="number" name="budget" min="10000" max="500000" value="50000" step="5000" required 
                     class="w-full px-4 py-3 text-sm bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
            </div>

            <!-- Predict Button -->
            <div class="mt-8">
              <button type="submit"
                class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold text-lg py-4 rounded-xl shadow-xl transition transform hover:scale-105 duration-200 flex items-center justify-center">
                üîÆ Predict Price
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Results & Analysis Panel -->
      <div class="lg:col-span-2">
        <div class="bg-white rounded-3xl shadow-2xl p-6 md:p-8">
          <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
            üìä Results & Analysis
          </h2>
          
          {% if predicted_price %}
            <!-- Prediction Result -->
            <div class="mb-8">
              <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-xl border border-green-200">
                <div class="text-center">
                  <h3 class="text-lg font-semibold text-gray-700 mb-2">üí∞ Predicted Price</h3>
                  <div class="text-4xl font-bold text-green-600 mb-4">‚Çπ{{ predicted_price|floatformat:0 }}</div>
                  
                  {% if budget %}
                    {% if predicted_price <= budget %}
                      <div class="bg-green-100 text-green-800 px-4 py-2 rounded-lg inline-block">
                        ‚úÖ Within budget!
                      </div>
                    {% else %}
                      <div class="bg-red-100 text-red-800 px-4 py-2 rounded-lg inline-block">
                        ‚ùå Over budget!
                      </div>
                    {% endif %}
                  {% endif %}
                </div>
              </div>
            </div>
            
            <!-- Tabs -->
            <div class="border-b border-gray-200 mb-6">
              <nav class="-mb-px flex space-x-8">
                <button class="tab-button active py-2 px-1 border-b-2 border-indigo-500 font-medium text-sm text-indigo-600" data-tab="analysis">
                  üìà Price Analysis
                </button>
                <button class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="comparison">
                  üîç Comparison
                </button>
                <button class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="recommendations">
                  üí° Recommendations
                </button>
                <button class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="summary">
                  üìã Summary
                </button>
              </nav>
            </div>
            
            <!-- Tab Content -->
            <div id="analysis" class="tab-content">
              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <h4 class="text-lg font-semibold mb-4">Price Breakdown</h4>
                  <div class="space-y-2">
                    <div class="flex justify-between"><span>Base Price:</span><span class="font-semibold">‚Çπ20,000</span></div>
                    <div class="flex justify-between"><span>Brand Premium:</span><span class="font-semibold">‚Çπ{{ brand_premium|default:"5,000" }}</span></div>
                    <div class="flex justify-between"><span>RAM:</span><span class="font-semibold">‚Çπ{{ ram_cost|default:"16,000" }}</span></div>
                    <div class="flex justify-between"><span>Storage:</span><span class="font-semibold">‚Çπ{{ storage_cost|default:"25,600" }}</span></div>
                    <div class="flex justify-between"><span>Graphics Card:</span><span class="font-semibold">‚Çπ{{ gpu_cost|default:"15,000" }}</span></div>
                    <div class="flex justify-between"><span>Display:</span><span class="font-semibold">‚Çπ{{ display_cost|default:"5,200" }}</span></div>
                  </div>
                </div>
                <div>
                  <h4 class="text-lg font-semibold mb-4">Feature Impact</h4>
                  <div class="space-y-3">
                    <div class="flex items-center">
                      <span class="w-20 text-sm">RAM</span>
                      <div class="flex-1 bg-gray-200 rounded-full h-2 mx-2">
                        <div class="bg-red-500 h-2 rounded-full" style="width: 85%"></div>
                      </div>
                      <span class="text-sm font-semibold">High</span>
                    </div>
                    <div class="flex items-center">
                      <span class="w-20 text-sm">Storage</span>
                      <div class="flex-1 bg-gray-200 rounded-full h-2 mx-2">
                        <div class="bg-blue-500 h-2 rounded-full" style="width: 70%"></div>
                      </div>
                      <span class="text-sm font-semibold">Medium</span>
                    </div>
                    <div class="flex items-center">
                      <span class="w-20 text-sm">GPU</span>
                      <div class="flex-1 bg-gray-200 rounded-full h-2 mx-2">
                        <div class="bg-green-500 h-2 rounded-full" style="width: 60%"></div>
                      </div>
                      <span class="text-sm font-semibold">Medium</span>
                    </div>
                    <div class="flex items-center">
                      <span class="w-20 text-sm">Display</span>
                      <div class="flex-1 bg-gray-200 rounded-full h-2 mx-2">
                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 40%"></div>
                      </div>
                      <span class="text-sm font-semibold">Low</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div id="comparison" class="tab-content hidden">
              <h4 class="text-lg font-semibold mb-4">Price Comparison with Similar Laptops</h4>
              <div class="grid md:grid-cols-4 gap-4">
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                  <h5 class="font-semibold text-blue-800">Budget Option</h5>
                  <div class="text-2xl font-bold text-blue-600">‚Çπ45,000</div>
                  <p class="text-sm text-blue-600">Similar specs, lower brand</p>
                </div>
                <div class="bg-green-50 p-4 rounded-lg text-center border-2 border-green-300">
                  <h5 class="font-semibold text-green-800">Your Configuration</h5>
                  <div class="text-2xl font-bold text-green-600">‚Çπ{{ predicted_price|floatformat:0 }}</div>
                  <p class="text-sm text-green-600">Selected specs</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg text-center">
                  <h5 class="font-semibold text-purple-800">Premium Option</h5>
                  <div class="text-2xl font-bold text-purple-600">‚Çπ75,000</div>
                  <p class="text-sm text-purple-600">Enhanced features</p>
                </div>
                <div class="bg-red-50 p-4 rounded-lg text-center">
                  <h5 class="font-semibold text-red-800">High-end</h5>
                  <div class="text-2xl font-bold text-red-600">‚Çπ95,000</div>
                  <p class="text-sm text-red-600">Top-tier specs</p>
                </div>
              </div>
            </div>
            
            <div id="recommendations" class="tab-content hidden">
              <h4 class="text-lg font-semibold mb-4">Budget Recommendations</h4>
              {% if budget and predicted_price > budget %}
                <div class="bg-yellow-50 p-4 rounded-lg mb-4">
                  <p class="text-yellow-800 font-semibold mb-2">üí° Your configuration exceeds budget</p>
                  <p class="text-yellow-700 mb-2">üîß Consider these alternatives:</p>
                  <ul class="text-yellow-700 space-y-1 ml-4">
                    <li>‚Ä¢ Reduce RAM from current selection</li>
                    <li>‚Ä¢ Choose a smaller storage capacity</li>
                    <li>‚Ä¢ Select integrated graphics instead of dedicated GPU</li>
                    <li>‚Ä¢ Consider a different brand</li>
                  </ul>
                </div>
              {% elif budget and predicted_price < budget %}
                <div class="bg-green-50 p-4 rounded-lg mb-4">
                  <p class="text-green-800 font-semibold mb-2">üí∞ You have extra budget available!</p>
                  <p class="text-green-700 mb-2">üöÄ Consider these upgrades:</p>
                  <ul class="text-green-700 space-y-1 ml-4">
                    <li>‚Ä¢ Increase RAM for better performance</li>
                    <li>‚Ä¢ Upgrade to a better graphics card</li>
                    <li>‚Ä¢ Choose a larger, higher-resolution display</li>
                    <li>‚Ä¢ Add more storage capacity</li>
                  </ul>
                </div>
              {% else %}
                <div class="bg-blue-50 p-4 rounded-lg mb-4">
                  <p class="text-blue-800 font-semibold mb-2">‚úÖ Your configuration fits well within your budget!</p>
                  <p class="text-blue-700">üéØ This is a good balance of features and price.</p>
                </div>
              {% endif %}
            </div>
            
            <div id="summary" class="tab-content hidden">
              <h4 class="text-lg font-semibold mb-4">Selected Configuration</h4>
              <div class="grid md:grid-cols-2 gap-6">
                <div class="space-y-2">
                  <div class="flex justify-between"><span class="font-semibold">Brand:</span><span>{{ inputs.brand }}</span></div>
                  <div class="flex justify-between"><span class="font-semibold">Processor:</span><span>{{ inputs.processor }}</span></div>
                  <div class="flex justify-between"><span class="font-semibold">RAM:</span><span>{{ inputs.ram }} GB</span></div>
                  <div class="flex justify-between"><span class="font-semibold">Storage:</span><span>{{ inputs.storage }} GB {{ inputs.storage_type }}</span></div>
                  <div class="flex justify-between"><span class="font-semibold">Graphics:</span><span>{{ inputs.gpu }}</span></div>
                </div>
                <div class="space-y-2">
                  <div class="flex justify-between"><span class="font-semibold">Display:</span><span>{{ inputs.display_size }}" {{ inputs.resolution }}</span></div>
                  <div class="flex justify-between"><span class="font-semibold">OS:</span><span>{{ inputs.os }}</span></div>
                  <div class="flex justify-between"><span class="font-semibold">Warranty:</span><span>{{ inputs.warranty }} years</span></div>
                  <div class="flex justify-between"><span class="font-semibold">Spec Rating:</span><span>{{ inputs.spec_rating }}/100</span></div>
                  <div class="flex justify-between border-t pt-2"><span class="font-bold text-lg">Predicted Price:</span><span class="font-bold text-lg text-green-600">‚Çπ{{ predicted_price|floatformat:0 }}</span></div>
                </div>
              </div>
            </div>
            
          {% else %}
            <!-- No Prediction Yet -->
            <div class="text-center py-12">
              <div class="text-6xl mb-4">üíª</div>
              <h3 class="text-xl font-semibold text-gray-700 mb-4">Configure Your Laptop</h3>
              <p class="text-gray-600 mb-8">üëà Configure your laptop specifications and click 'Predict Price' to see results!</p>
              
              <!-- Sample Predictions -->
              <div class="grid md:grid-cols-3 gap-4 mt-8">
                <div class="bg-blue-50 p-4 rounded-lg">
                  <h4 class="font-semibold text-blue-800 mb-2">Budget Laptop</h4>
                  <p class="text-sm text-blue-600 mb-2">Intel i3, 8GB RAM, 256GB SSD</p>
                  <div class="text-lg font-bold text-blue-600">‚Çπ35,000</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg">
                  <h4 class="font-semibold text-green-800 mb-2">Gaming Laptop</h4>
                  <p class="text-sm text-green-600 mb-2">Intel i7, 16GB RAM, RTX 3060</p>
                  <div class="text-lg font-bold text-green-600">‚Çπ85,000</div>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg">
                  <h4 class="font-semibold text-purple-800 mb-2">Premium Ultrabook</h4>
                  <p class="text-sm text-purple-600 mb-2">Intel i7, 16GB RAM, 512GB SSD</p>
                  <div class="text-lg font-bold text-purple-600">‚Çπ75,000</div>
                </div>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Tab functionality
document.addEventListener('DOMContentLoaded', function() {
  const tabButtons = document.querySelectorAll('.tab-button');
  const tabContents = document.querySelectorAll('.tab-content');
  
  tabButtons.forEach(button => {
    button.addEventListener('click', () => {
      const targetTab = button.getAttribute('data-tab');
      
      // Remove active class from all buttons and contents
      tabButtons.forEach(btn => {
        btn.classList.remove('active', 'border-indigo-500', 'text-indigo-600');
        btn.classList.add('border-transparent', 'text-gray-500');
      });
      
      tabContents.forEach(content => {
        content.classList.add('hidden');
      });
      
      // Add active class to clicked button and show corresponding content
      button.classList.add('active', 'border-indigo-500', 'text-indigo-600');
      button.classList.remove('border-transparent', 'text-gray-500');
      
      document.getElementById(targetTab).classList.remove('hidden');
    });
  });
});
</script>

{% endblock content %}